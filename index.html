<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Online Game Test</title>
<style>
body {
  font-family: sans-serif;
  background: #2c3e50;
  color: #ecf0f1;
  text-align: center;
  padding-top: 50px;
}
button {
  font-size: 24px;
  padding: 10px 30px;
}
</style>
</head>
<body>

<h1>オンライン同期テスト</h1>
<button id="btn">+1</button>
<p id="value">0</p>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
import { getDatabase, ref, set, onValue } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-database.js";
import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyBqzjuOEB7P5n_gtSwDUtaMa_CbtgAIeUk",
  authDomain: "online-game-572f5.firebaseapp.com",
  databaseURL: "https://online-game-572f5-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "online-game-572f5",
  storageBucket: "online-game-572f5.firebasestorage.app",
  messagingSenderId: "199079474526",
  appId: "1:199079474526:web:f7ffc6096d3173fb63cbcf"
};

// Firebase 初期化
const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const auth = getAuth(app);

// 匿名ログイン
await signInAnonymously(auth);

// データ参照
const counterRef = ref(db, "counter");

// データ受信
onValue(counterRef, (snapshot) => {
  document.getElementById("value").innerText = snapshot.val() ?? 0;
});

// ボタン処理
document.getElementById("btn").onclick = async () => {
  const v = Number(document.getElementById("value").innerText);
  await set(counterRef, v + 1);
};
</script>

</body>
</html>
